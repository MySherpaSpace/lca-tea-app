{"ast":null,"code":"import _objectSpread from\"/Users/mariasherpaspace/Documents/SherpaSpaceWorkFiles/Projects/LCA-TEA/LCA-TEA Coding/lca-tea-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/mariasherpaspace/Documents/SherpaSpaceWorkFiles/Projects/LCA-TEA/LCA-TEA Coding/lca-tea-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{cloneDeep}from\"lodash\";import{useState,createContext,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{homeAddress,storeKeys}from\"../utils/appConstants\";import{fetchLocalStorageItem,getNavURL,resetLocalStorage,setLocalStorageItem}from\"../utils/appUtils\";import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=/*#__PURE__*/createContext(null);var initToken={email:null,password:null,isLoading:true,isLoggedIn:false};function AuthProvider(_ref){var children=_ref.children;var navigate=useNavigate();var _useState=useState(initToken),_useState2=_slicedToArray(_useState,2),userToken=_useState2[0],setUserToken=_useState2[1];useEffect(function(){getLoginDetails();},[]);var getLoginDetails=function getLoginDetails(){try{var authObj=fetchLocalStorageItem(storeKeys[\"auth\"]);if(authObj!=null){setUserToken(_objectSpread(_objectSpread({},authObj),{},{isLoading:false}));}else{setUserToken(_objectSpread(_objectSpread({},initToken),{},{isLoading:false}));}}catch(error){//DEBUG_LOG:\nconsole.log(error);}};var handleLogin=function handleLogin(token){try{if(!token){return;}var tokenCopy=cloneDeep(token);delete tokenCopy.remember;if(token.remember){tokenCopy=_objectSpread(_objectSpread({},tokenCopy),{},{isLoggedIn:true,isLoading:false});setLocalStorageItem(storeKeys[\"auth\"],tokenCopy);}setUserToken(tokenCopy);navigate(homeAddress,{replace:true});}catch(error){//DEBUG_LOG:\nconsole.log(error);}};var handleLogout=function handleLogout(){try{resetLocalStorage();setUserToken(_objectSpread(_objectSpread({},initToken),{},{isLoggedIn:false,isLoading:false}));var loginUrl=getNavURL(\"/login\");navigate(loginUrl);}catch(error){//DEBUG_LOG:\nconsole.log(error);}};var value={userToken:userToken,onLogin:handleLogin,onLogout:handleLogout};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}export{AuthProvider};export default AuthContext;","map":{"version":3,"names":["cloneDeep","useState","createContext","useEffect","useNavigate","homeAddress","storeKeys","fetchLocalStorageItem","getNavURL","resetLocalStorage","setLocalStorageItem","AuthContext","initToken","email","password","isLoading","isLoggedIn","AuthProvider","children","navigate","userToken","setUserToken","getLoginDetails","authObj","error","console","log","handleLogin","token","tokenCopy","remember","replace","handleLogout","loginUrl","value","onLogin","onLogout"],"sources":["/Users/mariasherpaspace/Documents/SherpaSpaceWorkFiles/Projects/LCA-TEA/LCA-TEA Coding/lca-tea-app/src/context/AuthContext.js"],"sourcesContent":["import { cloneDeep } from \"lodash\";\nimport { useState, createContext, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { homeAddress, storeKeys } from \"../utils/appConstants\";\nimport { fetchLocalStorageItem, getNavURL, resetLocalStorage, setLocalStorageItem } from \"../utils/appUtils\";\n\nconst AuthContext = createContext(null);\n\nlet initToken = {\n  email: null,\n  password: null,\n  isLoading: true,\n  isLoggedIn: false\n}\n\nfunction AuthProvider({children}){\n  const navigate = useNavigate();\n  const [userToken, setUserToken] = useState(initToken);\n\n  useEffect(()=>{\n    getLoginDetails()\n  },[]);\n\n  const getLoginDetails = () => {\n    try {\n      let authObj = fetchLocalStorageItem(storeKeys[\"auth\"])\n\n      if(authObj!=null){\n        setUserToken({...authObj, isLoading: false})\n      }else{\n        setUserToken({...initToken, isLoading: false})\n      }\n    } catch (error) {\n      //DEBUG_LOG:\n      console.log(error);\n    }\n  }\n\n  const handleLogin = (token) => {\n    try {\n      if(!token){\n        return;\n      }\n\n      let tokenCopy = cloneDeep(token)\n      delete tokenCopy.remember\n\n\n      if(token.remember){\n        tokenCopy = {...tokenCopy, isLoggedIn: true, isLoading: false}\n        setLocalStorageItem(storeKeys[\"auth\"], tokenCopy);\n      }\n\n      setUserToken(tokenCopy);\n    \n      navigate(homeAddress, { replace: true });\n    } catch (error) {\n      //DEBUG_LOG:\n      console.log(error);\n    }\n  };\n\n  const handleLogout = () => {\n    try {\n      resetLocalStorage()\n\n      setUserToken({...initToken, isLoggedIn:false, isLoading: false});\n      const loginUrl = getNavURL(\"/login\")\n      navigate(loginUrl);\n    } catch (error) {\n      //DEBUG_LOG:\n      console.log(error);\n    }\n  };\n\n  const value = {\n    userToken,\n    onLogin: handleLogin,\n    onLogout: handleLogout\n  }\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport { AuthProvider };\nexport default AuthContext;"],"mappings":"+WAAA,OAASA,SAAS,KAAQ,QAAQ,CAClC,OAASC,QAAQ,CAAEC,aAAa,CAAEC,SAAS,KAAQ,OAAO,CAC1D,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,WAAW,CAAEC,SAAS,KAAQ,uBAAuB,CAC9D,OAASC,qBAAqB,CAAEC,SAAS,CAAEC,iBAAiB,CAAEC,mBAAmB,KAAQ,mBAAmB,CAAC,2CAE7G,GAAMC,YAAW,cAAGT,aAAa,CAAC,IAAI,CAAC,CAEvC,GAAIU,UAAS,CAAG,CACdC,KAAK,CAAE,IAAI,CACXC,QAAQ,CAAE,IAAI,CACdC,SAAS,CAAE,IAAI,CACfC,UAAU,CAAE,KACd,CAAC,CAED,QAASC,aAAY,MAAY,IAAVC,SAAQ,MAARA,QAAQ,CAC7B,GAAMC,SAAQ,CAAGf,WAAW,EAAE,CAC9B,cAAkCH,QAAQ,CAACW,SAAS,CAAC,wCAA9CQ,SAAS,eAAEC,YAAY,eAE9BlB,SAAS,CAAC,UAAI,CACZmB,eAAe,EAAE,CACnB,CAAC,CAAC,EAAE,CAAC,CAEL,GAAMA,gBAAe,CAAG,QAAlBA,gBAAe,EAAS,CAC5B,GAAI,CACF,GAAIC,QAAO,CAAGhB,qBAAqB,CAACD,SAAS,CAAC,MAAM,CAAC,CAAC,CAEtD,GAAGiB,OAAO,EAAE,IAAI,CAAC,CACfF,YAAY,gCAAKE,OAAO,MAAER,SAAS,CAAE,KAAK,GAAE,CAC9C,CAAC,IAAI,CACHM,YAAY,gCAAKT,SAAS,MAAEG,SAAS,CAAE,KAAK,GAAE,CAChD,CACF,CAAE,MAAOS,KAAK,CAAE,CACd;AACAC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CACpB,CACF,CAAC,CAED,GAAMG,YAAW,CAAG,QAAdA,YAAW,CAAIC,KAAK,CAAK,CAC7B,GAAI,CACF,GAAG,CAACA,KAAK,CAAC,CACR,OACF,CAEA,GAAIC,UAAS,CAAG7B,SAAS,CAAC4B,KAAK,CAAC,CAChC,MAAOC,UAAS,CAACC,QAAQ,CAGzB,GAAGF,KAAK,CAACE,QAAQ,CAAC,CAChBD,SAAS,gCAAOA,SAAS,MAAEb,UAAU,CAAE,IAAI,CAAED,SAAS,CAAE,KAAK,EAAC,CAC9DL,mBAAmB,CAACJ,SAAS,CAAC,MAAM,CAAC,CAAEuB,SAAS,CAAC,CACnD,CAEAR,YAAY,CAACQ,SAAS,CAAC,CAEvBV,QAAQ,CAACd,WAAW,CAAE,CAAE0B,OAAO,CAAE,IAAK,CAAC,CAAC,CAC1C,CAAE,MAAOP,KAAK,CAAE,CACd;AACAC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CACpB,CACF,CAAC,CAED,GAAMQ,aAAY,CAAG,QAAfA,aAAY,EAAS,CACzB,GAAI,CACFvB,iBAAiB,EAAE,CAEnBY,YAAY,gCAAKT,SAAS,MAAEI,UAAU,CAAC,KAAK,CAAED,SAAS,CAAE,KAAK,GAAE,CAChE,GAAMkB,SAAQ,CAAGzB,SAAS,CAAC,QAAQ,CAAC,CACpCW,QAAQ,CAACc,QAAQ,CAAC,CACpB,CAAE,MAAOT,KAAK,CAAE,CACd;AACAC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CACpB,CACF,CAAC,CAED,GAAMU,MAAK,CAAG,CACZd,SAAS,CAATA,SAAS,CACTe,OAAO,CAAER,WAAW,CACpBS,QAAQ,CAAEJ,YACZ,CAAC,CAED,mBACE,KAAC,WAAW,CAAC,QAAQ,EAAC,KAAK,CAAEE,KAAM,UAChChB,QAAQ,EACY,CAE3B,CAEA,OAASD,YAAY,EACrB,cAAeN,YAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}